import{j as e,u as F,a as N,r as w,R as d,t as x,l as S,b as k,N as L}from"./index-C9n7polI.js";import{B as M}from"./button-DUMtW0hL.js";import{t as f,c as v}from"./utils-CPYLdFy8.js";import{F as C,a as I,b as P,c as h,d as R,e as A}from"./form-CDg5v4lv.js";import{I as j}from"./input-DhgAi3x7.js";import{l as q}from"./lodash-BQbGx-gA.js";import{u as B,F as T}from"./index.esm-CnDZ_wpV.js";import{o as D,s as p,a as H,u as U}from"./schemas-BlOts8Bb.js";import"./index-H52uSeXi.js";import"./index-BdrbzQWw.js";import"./index-D3hs_IWB.js";import"./index-BBH-RmWy.js";const z="/assets/right-logo-z32Bfk7u.jpg",V="/assets/logo-CXSMktE5.jpg",b=({control:s,name:t,label:o,helperText:r,required:l,className:c,rules:n,floatingError:g,...a})=>{const i=o&&e.jsxs(A,{className:"my-3",children:[o," ",l&&e.jsx("span",{className:"text-red-600",children:"*"})]});return t&&s?e.jsx(C,{control:s,name:t,rules:n,render:({field:m,formState:E})=>e.jsxs(I,{children:[i,e.jsx(P,{children:e.jsx(j,{variant:q.get(E.errors,`${t}.message`)?"failure":"default",...a,...m,onChange:y=>{const u=y.target.value;a.type==="number"?m.onChange(u?Number(u):void 0):m.onChange(u)},className:f(["mt-2",c])})}),r&&e.jsx(h,{children:r}),e.jsx(R,{className:v(g)})]})}):e.jsxs(e.Fragment,{children:[i,e.jsx(j,{...a,className:f(["mt-2",c])}),e.jsx(h,{children:r})]})},X=D({username:p(),password:p().min(1,"Parol kamida 1 belgidan iborat boâ€˜lishi kerak")}),$=()=>{const s=F(),{login:t,fetchMe:o,user:r,loading:l}=N(),c=B({resolver:H(X),defaultValues:{}}),n=U({mutationFn:S,onSuccess:async a=>{const i=a.token;i&&(t(i),await o())},onError:a=>{console.error("Error:",a),x.error(a.message)}});return w.useEffect(()=>{n.isSuccess&&!l&&r&&(r.role===d.TEACHER?s("/teacher"):r.role===d.STUDENT?s("/student"):(s("/login"),alert(1),x.error("Foydalanuvchi roli aniqlanmadi")))},[n.isSuccess,l,r,s]),{form:c,loginMutation:n,onSubmit:a=>{n.mutate(a)}}},G=()=>{const{form:s,onSubmit:t,loginMutation:o}=$();return e.jsx(T,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(t),className:v("flex flex-col gap-10"),children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Login to your account"}),e.jsx("p",{className:"text-muted-foreground text-sm text-balance",children:"Enter your email below to login to your account"})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx("div",{className:"grid gap-3",children:e.jsx(b,{required:!0,floatingError:!0,label:"Username",placeholder:"Enter your username",control:s.control,name:"username",type:"text"})}),e.jsx("div",{className:"grid gap-3",children:e.jsx(b,{required:!0,floatingError:!0,label:"Password",placeholder:"Enter your password",control:s.control,name:"password",type:"password"})}),e.jsx(M,{type:"submit",className:"w-full",loading:o.isPending,children:"Login"})]})]})})};function te(){const{isAuthenticated:s,user:t,loading:o}=N(),r=k();return s&&!o?e.jsx(L,{to:t?.role===d.TEACHER?"/teacher":"/student",state:{from:r},replace:!0}):e.jsxs("div",{className:"grid min-h-screen lg:grid-cols-2",children:[e.jsx("div",{className:"flex flex-col gap-4 p-6 md:p-10",children:e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-xs",children:[e.jsx("div",{className:"flex items-center justify-center mb-12 ",children:e.jsx("img",{src:V,alt:"",className:"w-32"})}),e.jsx(G,{})]})})}),e.jsx("div",{className:"bg-muted relative hidden lg:block",children:e.jsx("img",{src:z,alt:"Image",className:"absolute inset-0 h-full w-full object-cover dark:brightness-[0.2] dark:grayscale"})})]})}export{te as default};
