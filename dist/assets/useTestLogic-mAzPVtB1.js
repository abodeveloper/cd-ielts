import{a as X,j as i,c as G,R as U,r as s,h as Y,b as Q,u as Z,t as ee}from"./index-4kS3dc92.js";import{B as O}from"./button-DbvuEKFN.js";import{C as te,a as ne,c as re,d as se}from"./card-BhQ0nrJq.js";import{C as oe,R as le,_ as ae,i as J,M as ie}from"./index-BG-AEQrd.js";import{l as z}from"./lodash-Cfwg2KdB.js";import{p as ce,l as ue}from"./index-Cif9kCc3.js";function be({onNext:o}){const{user:b}=X();return i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-muted w-full",children:i.jsxs(te,{className:"w-full max-w-lg shadow-lg",children:[i.jsxs(ne,{className:"flex items-center space-x-2",children:[i.jsx(oe,{className:"w-12 h-12"}),i.jsx("h1",{className:"scroll-m-20 text-center text-lg font-extrabold tracking-tight text-balance",children:"Confirm your details"})]}),i.jsxs(re,{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",z.get(b,"full_name")]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone number:"})," ",z.get(b,"phone")]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-center text-center md:flex-row md:items-center md:text-left",children:[i.jsx(le,{}),i.jsx("span",{children:"If your details are not correct, please"}),i.jsx(G,{to:b?.role===U.TEACHER?"/teacher/profile":"/student/profile",className:"text-blue-600 flex gap-2 items-center",children:"update your profile."})]})]}),i.jsx(se,{children:i.jsx(O,{className:"w-full",onClick:o,children:"My details are correct"})})]})})}function xe({steps:o}){const[b,h]=s.useState(0),[T,w]=s.useState({}),m=k=>{b<o.length-1&&(k&&w(v=>({...v,...k})),h(v=>v+1))};s.useEffect(()=>{const v=o[b]?.props?.disableOverflow??!1;return v||(document.body.style.overflow="hidden"),()=>{v||(document.body.style.overflow="auto")}},[b,o]);const x=o[b];return i.jsx("div",{children:Y.isValidElement(x)&&Y.cloneElement(x,{onNext:m,formData:T})})}const K=o=>o&&o.replace(/\r\n/g,"<br>").replace(/\n/g,"<br>"),de=o=>o&&(o.includes("<")?o.replace(/>([^<]*?)</g,(b,h)=>h.trim()?`>${K(h)}<`:b):K(o)),he=({src:o,alt:b,style:h,className:T})=>{const w=s.useRef(null),m=s.useRef(null),x=s.useRef(null),[k,v]=s.useState(!1),[N,f]=s.useState(!1),[R,F]=s.useState(!1),[C,E]=s.useState("black");s.useEffect(()=>{const n=m.current,u=x.current;if(!n||!u)return;const d=n.getContext("2d");if(!d)return;const p=()=>{if(u&&n){const e=u.getBoundingClientRect(),r=window.devicePixelRatio||1,a=d.globalCompositeOperation,y=d.lineWidth,S=d.strokeStyle;n.width=e.width*r,n.height=e.height*r,n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,d.setTransform(1,0,0,1,0,0),d.scale(r,r),d.globalCompositeOperation=a,d.lineWidth=y,d.strokeStyle=S,d.lineCap="round",d.lineJoin="round"}},t=()=>{p()};u.complete?t():u.addEventListener("load",t);const l=new ResizeObserver(()=>{p()});return u&&l.observe(u),()=>{u.removeEventListener("load",t),l.disconnect()}},[o]),s.useEffect(()=>{const n=m.current;if(!n)return;const u=n.getContext("2d");if(u)if(R)u.globalCompositeOperation="destination-out",u.lineWidth=20,u.lineCap="round",u.lineJoin="round";else{u.globalCompositeOperation="source-over";const d={black:"#000000",red:"#ff0000",yellow:"#ffeb3b"};u.strokeStyle=d[C],u.lineWidth=5,u.lineCap="round",u.lineJoin="round"}},[R,C]);const P=n=>{const u=m.current;if(!u)return{x:0,y:0};const d=u.getBoundingClientRect(),p="touches"in n?n.touches[0]?.clientX||0:n.clientX,t="touches"in n?n.touches[0]?.clientY||0:n.clientY;return{x:p-d.left-2,y:t-d.top-4}},g=n=>{const u=window.getSelection();if(u&&u.toString().trim().length>0)return;n.preventDefault(),f(!0),v(!0);const d=m.current,p=d?.getContext("2d");if(!d||!p)return;const{x:t,y:l}=P(n);p.beginPath(),p.moveTo(t,l)},B=n=>{if(!k)return;const u=window.getSelection();if(u&&u.toString().trim().length>0){v(!1);return}n.preventDefault();const d=m.current,p=d?.getContext("2d");if(!d||!p)return;const{x:t,y:l}=P(n);p.lineTo(t,l),p.stroke()},q=n=>{n&&n.preventDefault(),v(!1)},W=()=>{f(!1),v(!1)},I=()=>{f(!0)},M=R?"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23ff0000%22 stroke-width=%222%22><rect x=%223%22 y=%223%22 width=%2218%22 height=%2218%22 rx=%222%22/><path d=%22M8 8l8 8M16 8l-8 8%22/></svg>') 12 12, auto":"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23000%22 stroke-width=%222%22><path d=%22M12 19l7-7 3 3-7 7-3-3z%22/><path d=%22M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z%22/><path d=%22M2 2l7.586 7.586%22/><path d=%22M11 11l2 2%22/></svg>') 12 6, auto";return s.useEffect(()=>{const n=w.current;if(!n)return;const u=p=>{const t=window.getSelection();t&&t.rangeCount>0&&p.stopPropagation()},d=p=>{const t=window.getSelection();t&&t.toString().trim().length>0&&p.stopPropagation()};return n.addEventListener("scroll",u,{passive:!0}),n.addEventListener("wheel",d,{passive:!0}),()=>{n.removeEventListener("scroll",u),n.removeEventListener("wheel",d)}},[]),i.jsxs("div",{className:"relative inline-block image-drawer-container",children:[i.jsxs("div",{ref:w,className:"relative inline-block group image-drawer-container",style:{cursor:N?M:"default"},onMouseEnter:n=>{n.stopPropagation(),I()},onMouseLeave:n=>{n.stopPropagation(),W()},onClick:n=>{const u=window.getSelection();u&&u.toString().trim().length>0||n.stopPropagation()},onScroll:n=>{n.stopPropagation()},children:[i.jsx("img",{ref:x,src:o,alt:b||"",style:h,className:T,draggable:!1}),i.jsx("canvas",{ref:m,className:"absolute top-0 left-0 pointer-events-auto",style:{cursor:N?M:"default"},onMouseDown:g,onMouseMove:B,onMouseUp:q,onMouseLeave:q,onTouchStart:g,onTouchMove:B,onTouchEnd:q})]}),i.jsx("br",{}),i.jsx("br",{}),i.jsxs("div",{className:"absolute top-16 right-0 -translate-y-full mb-2 flex items-center gap-2 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg p-2 border border-gray-200",children:[!R&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),E("black")},className:`w-7 h-7 rounded-full border-2 transition-all hover:scale-110 ${C==="black"?"border-gray-900 scale-110 shadow-md ring-2 ring-gray-300":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:"#000000"}}),i.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),E("red")},className:`w-7 h-7 rounded-full border-2 transition-all hover:scale-110 ${C==="red"?"border-gray-900 scale-110 shadow-md ring-2 ring-red-200":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:"#ff0000"}}),i.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),E("yellow")},className:`w-7 h-7 rounded-full border-2 transition-all hover:scale-110 ${C==="yellow"?"border-gray-900 scale-110 shadow-md ring-2 ring-yellow-200":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:"#ffeb3b"}})]}),i.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),F(!R)},className:`p-2 rounded-md shadow-sm transition-all hover:scale-105 ${R?"bg-red-500 text-white hover:bg-red-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:R?i.jsx(ae,{className:"w-4 h-4"}):i.jsx(J,{className:"w-4 h-4"})})]})]})},ve=({htmlString:o,className:b="",enabledHighlight:h=!0,storageKey:T})=>{const w=s.useRef(null),[m,x]=s.useState(null),[k,v]=s.useState(null),[N,f]=s.useState(null),R=s.useRef(0),F=s.useRef(null),[C,E]=s.useState(o),P=s.useRef(!1),g=()=>Date.now().toString()+Math.random().toString(36).slice(2),B=t=>{if(!w.current)return[];const l=[],e=document.createTreeWalker(w.current,NodeFilter.SHOW_ELEMENT,{acceptNode(a){if(!(a instanceof HTMLElement))return NodeFilter.FILTER_REJECT;const y=window.getComputedStyle(a);return(y.display==="block"||y.display==="list-item"||y.display==="table"||["P","DIV","LI"].includes(a.tagName))&&t.intersectsNode(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);let r=e.nextNode();for(;r;)l.push(r),r=e.nextNode();return l},q=(t,l)=>{const e=t.extractContents(),r=document.createElement("span");r.className="highlight",r.dataset.highlightId=l,r.appendChild(e),t.insertNode(r),T&&w.current&&setTimeout(()=>{if(w.current)try{localStorage.setItem(`highlights_${T}`,w.current.innerHTML)}catch(a){console.warn("Failed to save highlights:",a)}},0)},W=()=>{if(!h||!m)return;const t=m.cloneRange(),l=g(),e=B(t);e.length===0?q(t,l):e.forEach(r=>{const a=document.createRange();let y=t.startContainer,S=t.startOffset,L=t.endContainer,D=t.endOffset;r.contains(y)||(y=r,S=0),r.contains(L)||(L=r,D=r.childNodes.length);try{a.setStart(y,S),a.setEnd(L,D),a.collapsed||q(a,l)}catch{}}),x(null),v(null),f(null)},I=s.useCallback(()=>{h&&(F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{const t=window.getSelection();if(t&&t.rangeCount>0&&w.current?.contains(t.anchorNode)){const l=t.getRangeAt(0),e=t.toString().trim();if(!l.collapsed&&e.length>0){const r=l.getBoundingClientRect();let a=l.commonAncestorContainer;a.nodeType===Node.TEXT_NODE&&(a=a.parentNode),a&&a.classList&&a.classList.contains("highlight")?(f(a),x(null)):(f(null),x(l));const y=window.innerWidth,S=200,L=50;let D=r.left+window.scrollX+r.width/2;D+S/2>y+window.scrollX?D=y+window.scrollX-S/2-10:D-S/2<window.scrollX&&(D=window.scrollX+S/2+10);let _=r.top+window.scrollY-L-35;_<window.scrollY&&(_=r.bottom+window.scrollY+35),v({x:D,y:_,width:S})}else x(null),f(null),v(null)}else x(null),f(null),v(null)},150))},[h]),c=s.useCallback(()=>{const t=Date.now();t-R.current<300||(R.current=t,I())},[I]),j=s.useCallback(()=>{I()},[I]);s.useEffect(()=>{if(!h)return;document.addEventListener("mouseup",c),document.addEventListener("dblclick",j);const t=e=>{const r=e.target;r.closest("img")||r.closest(".image-drawer-container")||r.tagName==="IMG"||w.current?.contains(r)||(f(null),v(null))},l=e=>{const r=window.getSelection();r&&r.toString().trim().length>0&&e.stopPropagation()};return document.body.addEventListener("click",t),window.addEventListener("scroll",l,{passive:!0}),document.addEventListener("scroll",l,{passive:!0}),()=>{document.removeEventListener("mouseup",c),document.removeEventListener("dblclick",j),document.body.removeEventListener("click",t),window.removeEventListener("scroll",l),document.removeEventListener("scroll",l),F.current&&clearTimeout(F.current)}},[c,j,h]);const M=t=>{t.stopPropagation();const l=t.currentTarget;f(l),x(null);const e=l.getBoundingClientRect(),r=window.innerWidth,a=200,y=50;let S=e.left+window.scrollX+e.width/2;S+a/2>r+window.scrollX?S=r+window.scrollX-a/2-10:S-a/2<window.scrollX&&(S=window.scrollX+a/2+10);let L=e.top+window.scrollY-y-35;L<window.scrollY&&(L=e.bottom+window.scrollY+35),v({x:S,y:L,width:a})},n=()=>{if(h){if(N){const t=N,l=t.parentNode;if(l){for(;t.firstChild;)l.insertBefore(t.firstChild,t);l.removeChild(t)}}else if(m&&!N){const t=m.cloneRange();if(!w.current)return;const l=[],e=document.createTreeWalker(w.current,NodeFilter.SHOW_ELEMENT,{acceptNode(a){return a instanceof HTMLElement&&a.classList.contains("highlight")&&t.intersectsNode(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);let r=e.nextNode();for(;r;)l.push(r),r=e.nextNode();l.forEach(a=>{const y=a.parentNode;if(y){for(;a.firstChild;)y.insertBefore(a.firstChild,a);y.removeChild(a)}})}T&&w.current&&setTimeout(()=>{if(w.current)try{localStorage.setItem(`highlights_${T}`,w.current.innerHTML)}catch(t){console.warn("Failed to save highlights:",t)}},0),x(null),f(null),v(null)}};s.useEffect(()=>{E(o),P.current=!1},[o]),s.useEffect(()=>{if(T&&w.current&&!P.current)try{const t=localStorage.getItem(`highlights_${T}`);t?setTimeout(()=>{if(w.current){const l=document.createElement("div");l.innerHTML=t;const e=l.querySelectorAll(".highlight");e.length>0&&e.forEach(r=>{const a=r.getAttribute("data-highlight-id"),y=r.textContent;if(y&&w.current){const S=document.createTreeWalker(w.current,NodeFilter.SHOW_TEXT,null);let L;for(;L=S.nextNode();){const _=(L.textContent||"").indexOf(y);if(_!==-1&&L.parentElement&&!L.parentElement.classList.contains("highlight"))try{const H=document.createRange();H.setStart(L,_),H.setEnd(L,_+y.length);const $=document.createElement("span");$.className="highlight",$.dataset.highlightId=a||Date.now().toString();const V=H.extractContents();$.appendChild(V),H.insertNode($);break}catch{}}}})}P.current=!0},150):P.current=!0}catch(t){console.warn("Failed to restore highlights:",t),P.current=!0}},[T,C]);const u=typeof C=="string"&&C.trim().length>0?C:o,d=de(u),p=ce(d,{replace:t=>{if(t.type==="tag"&&t.name==="span"&&t.attribs&&t.attribs.class&&t.attribs.class.includes("highlight"))return s.createElement("span",{...t.attribs,onClick:M,style:{cursor:"pointer"},key:t.attribs["data-highlight-id"]||void 0},t.children&&ue.domToReact(t.children));if(t.type==="tag"&&t.name==="img"&&t.attribs){const{src:l,alt:e,style:r,className:a}=t.attribs;let y={};return r&&r.split(";").forEach(S=>{const[L,D]=S.split(":").map(_=>_.trim());if(L&&D){const _=L.replace(/-([a-z])/g,H=>H[1].toUpperCase());y[_]=D}}),i.jsx(he,{src:l||"",alt:e||"",style:y,className:a||""},l||Math.random().toString())}}});return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .highlight {
          background-color: #fde68a;
        }
      `}),i.jsx("div",{ref:w,className:`w-full text-sm text-[--foreground] ${b}
          [&_table]:w-full [&_table]:border-collapse
          [&_td]:border [&_td]:border-[--border] [&_td]:p-2
          [&_th]:border [&_th]:border-[--border] [&_th]:p-2
          [&_p]:mb-2 [&_p]:text-[--foreground]
          [&_h3]:text-lg [&_h3]:font-semibold [&_h3]:mb-2 [&_h3]:text-[--foreground]
          [&_strong]:font-bold [&_em]:italic select-text`,style:{userSelect:"text"},children:p}),h&&k&&(m||N)&&i.jsxs("div",{className:"absolute z-50 flex gap-2 rounded-lg border bg-muted p-2 shadow-lg -translate-x-1/2",style:{left:k.x,top:k.y},children:[!N&&i.jsxs(O,{size:"sm",onClick:W,children:[i.jsx(ie,{className:"mr-1 h-4 w-4"})," Highlight"]}),i.jsxs(O,{size:"sm",variant:"destructive",onClick:n,disabled:!N&&!m,children:[i.jsx(J,{className:"mr-1 h-4 w-4"})," Clear"]})]})]})};let A=null;try{const o=require("react-router-dom");typeof o.useBlocker=="function"&&(A=o.useBlocker)}catch{}const ke=o=>{const{user:b}=X(),h=Q(),T=Z(),w=typeof o=="boolean"?{shouldBlock:o}:o,{shouldBlock:m,audioRef:x,timeLeft:k,isAudioPlaying:v,customMessage:N}=w,f=b?.role===U.STUDENT,R=()=>x?.current?!x.current.paused&&!x.current.ended:!1,F=()=>k==null?!1:k>0,C=s.useCallback(c=>c.includes("/readings/")||c.includes("/listenings/")||c.includes("/writings/")||c.includes("/speakings/"),[]),E=s.useCallback(()=>!f||!m?!1:m,[f,m]),P=s.useCallback(()=>navigator.platform.toUpperCase().indexOf("MAC")>=0||navigator.userAgent.toUpperCase().indexOf("MAC")>=0,[]),g=s.useCallback(()=>{const c=document.documentElement;P()?c.webkitRequestFullscreen?c.webkitRequestFullscreen():c.requestFullscreen&&c.requestFullscreen().catch(M=>{console.error("Fullscreen error:",M)}):c.requestFullscreen?c.requestFullscreen().catch(M=>{console.error("Fullscreen error:",M)}):c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen()},[P]),B=s.useCallback(()=>{document.exitFullscreen&&document.fullscreenElement&&document.exitFullscreen().catch(c=>{console.error("Fullscreen rejimidan chiqishda xato:",c)})},[]),q=s.useCallback(c=>{const j=E();f&&j&&(c&&c.preventDefault(),history.pushState(null,"",h.pathname),alert("You cannot leave the page during the test."),g())},[f,m,x,k,h.pathname,T,g]),W=s.useCallback(()=>f?C(h.pathname)&&m:!1,[f,h.pathname,m,C]),I=A?A(W):null;s.useEffect(()=>{I&&I.state==="blocked"&&(alert("You cannot leave the page during the test. Please wait until the test time is up."),I.reset(),g())},[I,g]),s.useEffect(()=>{if(!f)return;const c=C(h.pathname);if(!(c&&m))return;const M=n=>{const d=n.target.closest("a[href]");if(d&&d.href)try{const p=new URL(d.href),t=new URL(window.location.href);if(p.origin===t.origin&&p.pathname!==t.pathname&&c&&!C(p.pathname))return n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),alert("You cannot leave the page during the test. Please wait until the test time is up."),g(),!1}catch{}};return document.addEventListener("click",M,!0),()=>{document.removeEventListener("click",M,!0)}},[f,h.pathname,m,C,g]),s.useEffect(()=>{if(!f)return;if(!m){B();const e=`fullscreen_alert_shown_${h.pathname}`;sessionStorage.removeItem(e);return}const c=`fullscreen_alert_shown_${h.pathname}`;sessionStorage.removeItem(c),g();const j=e=>{if(E()&&f)return e.preventDefault(),e.returnValue="You cannot reload the page during the test.",history.pushState(null,"",h.pathname),"You cannot reload the page during the test."},M=e=>{const r=E();if(r&&f&&(e.key==="F5"||e.key==="F4"&&e.altKey||e.ctrlKey&&!e.shiftKey&&(e.key==="r"||e.key==="R")||e.ctrlKey&&e.shiftKey&&(e.key==="r"||e.key==="R")||e.ctrlKey&&e.key==="F5"||e.metaKey&&!e.shiftKey&&(e.key==="r"||e.key==="R")||e.metaKey&&e.shiftKey&&(e.key==="r"||e.key==="R")))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),alert("You cannot reload the page during the test."),g(),history.pushState(null,"",h.pathname),!1;r&&e.key==="Escape"&&(e.preventDefault(),e.stopPropagation(),alert("You cannot leave the page during the test."),g()),r&&e.key==="F11"&&(e.preventDefault(),confirm(`Test tugamaguncha fullscreen rejimidan chiqish taqiqlangan!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g()),r&&(e.altKey&&e.key==="Tab"||e.ctrlKey&&e.key==="Tab")&&(e.preventDefault(),confirm(`Test tugamaguncha boshqa oynaga o'tish taqiqlangan!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())},n=()=>{if(E()&&!document.fullscreenElement){const r=`fullscreen_alert_shown_${h.pathname}`;sessionStorage.getItem(r)?setTimeout(()=>{g()},50):(sessionStorage.setItem(r,"true"),alert("You cannot exit the test until the test time is up"),setTimeout(()=>{g()},100))}},u=e=>{E()&&(e.preventDefault(),confirm(`Test tugamaguncha o'ng tugma menyusi ishlamaydi!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())},d=e=>{E()&&(e.key==="F12"||e.ctrlKey&&e.shiftKey&&(e.key==="I"||e.key==="J")||e.ctrlKey&&e.key==="u")&&(e.preventDefault(),confirm(`Test tugamaguncha developer tools ishlamaydi!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())};window.addEventListener("beforeunload",j),window.addEventListener("keydown",M),window.addEventListener("keydown",d);const p=e=>{q(e)};window.addEventListener("popstate",p),document.addEventListener("fullscreenchange",n),document.addEventListener("contextmenu",u);const t=()=>{E()&&R()&&setTimeout(()=>{window.focus(),g()},100)};window.addEventListener("blur",t);const l=e=>{E()&&(e.preventDefault(),history.pushState(null,"",h.pathname),confirm(`Test tugamaguncha browser navigation tugmalari ishlamaydi!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())};return E()&&history.pushState(null,"",h.pathname),window.addEventListener("hashchange",l),()=>{window.removeEventListener("beforeunload",j),window.removeEventListener("keydown",M),window.removeEventListener("keydown",d),window.removeEventListener("popstate",p),document.removeEventListener("fullscreenchange",n),document.removeEventListener("contextmenu",u),window.removeEventListener("blur",t),window.removeEventListener("hashchange",l)}},[f,m,x,k,q,g,B,h.pathname,E,F])},Ee=(o,b,h,T=!0,w)=>{const[m,x]=s.useState(o),[k,v]=s.useState(!1),[N,f]=s.useState(""),R=s.useRef(null),F=s.useRef(null),C=s.useRef(!1),E=s.useRef(!1),P=()=>{F.current&&(clearInterval(F.current),F.current=null)};s.useEffect(()=>{o!==null?(R.current=Date.now()+o*1e3,x(o),C.current=!1):(R.current=null,x(null))},[o]),s.useEffect(()=>{if(o===null||k||!T&&!E.current)return;!E.current&&o!==null&&(R.current=Date.now()+o*1e3,x(o)),E.current=!0;const c=()=>{if(R.current===null)return;const j=Math.max(0,Math.round((R.current-Date.now())/1e3));x(j),j===0&&!k&&!C.current&&(P(),C.current=!0,v(!0),ee.error("The time limit has expired."),h())};return c(),F.current=setInterval(c,1e3),()=>{(k||!E.current)&&P()}},[o,k,h,T]),s.useEffect(()=>{b.length>0&&!N&&f(`tab-${b[0].id}`)},[b,N]);const g=b.findIndex(c=>`tab-${c.id}`===N);return{timeLeft:m??0,formatTime:c=>`${Math.floor(c/60).toString().padStart(2,"0")}:${(c%60).toString().padStart(2,"0")}`,activeTab:N,setActiveTab:f,currentTabIndex:g,handlePrevious:()=>g>0&&f(`tab-${b[g-1].id}`),handleNext:()=>g<b.length-1&&f(`tab-${b[g+1].id}`),isTestFinished:k,finishTest:()=>{o!==null&&!k&&(P(),h(),v(!0))}}};export{be as C,xe as F,ve as H,he as I,ke as a,Ee as u};
