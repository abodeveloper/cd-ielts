import{a as X,j as u,c as G,R as U,r as s,h as Y,b as Q,u as Z,t as ee}from"./index-Dh3ubDwU.js";import{B as O}from"./button-9L7vWsQ-.js";import{C as te,a as ne,c as re,d as se}from"./card-BRFnytp6.js";import{C as oe,R as le,_ as ae,i as J,M as ie}from"./index-QLsX0NeK.js";import{l as z}from"./lodash-CJSAy_eg.js";import{p as ce,l as ue}from"./index-WhjHehdF.js";function be({onNext:l}){const{user:x}=X();return u.jsx("div",{className:"flex items-center justify-center min-h-screen bg-muted w-full",children:u.jsxs(te,{className:"w-full max-w-lg shadow-lg",children:[u.jsxs(ne,{className:"flex items-center space-x-2",children:[u.jsx(oe,{className:"w-12 h-12"}),u.jsx("h1",{className:"scroll-m-20 text-center text-lg font-extrabold tracking-tight text-balance",children:"Confirm your details"})]}),u.jsxs(re,{className:"space-y-8",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Name:"})," ",z.get(x,"full_name")]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Phone number:"})," ",z.get(x,"phone")]})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 items-center text-center md:flex-row md:items-center md:text-left",children:[u.jsx(le,{}),u.jsx("span",{children:"If your details are not correct, please"}),u.jsx(G,{to:x?.role===U.TEACHER?"/teacher/profile":"/student/profile",className:"text-blue-600 flex gap-2 items-center",children:"update your profile."})]})]}),u.jsx(se,{children:u.jsx(O,{className:"w-full",onClick:l,children:"My details are correct"})})]})})}function xe({steps:l}){const[x,d]=s.useState(0),[N,p]=s.useState({}),m=w=>{x<l.length-1&&(w&&p(k=>({...k,...w})),d(k=>k+1))};s.useEffect(()=>{const k=l[x]?.props?.disableOverflow??!1;return k||(document.body.style.overflow="hidden"),()=>{k||(document.body.style.overflow="auto")}},[x,l]);const v=l[x];return u.jsx("div",{children:Y.isValidElement(v)&&Y.cloneElement(v,{onNext:m,formData:N})})}const K=l=>l&&l.replace(/\r\n/g,"<br>").replace(/\n/g,"<br>"),de=l=>l&&(l.includes("<")?l.replace(/>([^<]*?)</g,(x,d)=>d.trim()?`>${K(d)}<`:x):K(l)),he=({src:l,alt:x,style:d,className:N})=>{const p=s.useRef(null),m=s.useRef(null),v=s.useRef(null),[w,k]=s.useState(!1),[F,f]=s.useState(!1),[T,L]=s.useState(!1),[C,E]=s.useState("black");s.useEffect(()=>{const n=m.current,a=v.current;if(!n||!a)return;const h=n.getContext("2d");if(!h)return;const y=()=>{if(a&&n){const e=a.getBoundingClientRect(),r=window.devicePixelRatio||1,c=h.globalCompositeOperation,b=h.lineWidth,S=h.strokeStyle;n.width=e.width*r,n.height=e.height*r,n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,h.setTransform(1,0,0,1,0,0),h.scale(r,r),h.globalCompositeOperation=c,h.lineWidth=b,h.strokeStyle=S,h.lineCap="round",h.lineJoin="round"}},t=()=>{y()};a.complete?t():a.addEventListener("load",t);const o=new ResizeObserver(()=>{y()});return a&&o.observe(a),()=>{a.removeEventListener("load",t),o.disconnect()}},[l]),s.useEffect(()=>{const n=m.current;if(!n)return;const a=n.getContext("2d");if(a)if(T)a.globalCompositeOperation="destination-out",a.lineWidth=20,a.lineCap="round",a.lineJoin="round";else{a.globalCompositeOperation="source-over";const h={black:"#000000",red:"#ff0000",yellow:"#ffeb3b"};a.strokeStyle=h[C],a.lineWidth=5,a.lineCap="round",a.lineJoin="round"}},[T,C]);const j=n=>{const a=m.current;if(!a)return{x:0,y:0};const h=a.getBoundingClientRect(),y="touches"in n?n.touches[0]?.clientX||0:n.clientX,t="touches"in n?n.touches[0]?.clientY||0:n.clientY;return{x:y-h.left-2,y:t-h.top-4}},g=n=>{const a=window.getSelection();if(a&&a.toString().trim().length>0)return;n.preventDefault(),f(!0),k(!0);const h=m.current,y=h?.getContext("2d");if(!h||!y)return;const{x:t,y:o}=j(n);y.beginPath(),y.moveTo(t,o)},B=n=>{if(!w)return;const a=window.getSelection();if(a&&a.toString().trim().length>0){k(!1);return}n.preventDefault();const h=m.current,y=h?.getContext("2d");if(!h||!y)return;const{x:t,y:o}=j(n);y.lineTo(t,o),y.stroke()},q=n=>{n&&n.preventDefault(),k(!1)},W=()=>{f(!1),k(!1)},M=()=>{f(!0)},D=T?"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23ff0000%22 stroke-width=%222%22><rect x=%223%22 y=%223%22 width=%2218%22 height=%2218%22 rx=%222%22/><path d=%22M8 8l8 8M16 8l-8 8%22/></svg>') 12 12, auto":"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23000%22 stroke-width=%222%22><path d=%22M12 19l7-7 3 3-7 7-3-3z%22/><path d=%22M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z%22/><path d=%22M2 2l7.586 7.586%22/><path d=%22M11 11l2 2%22/></svg>') 12 6, auto";return s.useEffect(()=>{const n=p.current;if(!n)return;const a=y=>{const t=window.getSelection();t&&t.rangeCount>0&&y.stopPropagation()},h=y=>{const t=window.getSelection();t&&t.toString().trim().length>0&&y.stopPropagation()};return n.addEventListener("scroll",a,{passive:!0}),n.addEventListener("wheel",h,{passive:!0}),()=>{n.removeEventListener("scroll",a),n.removeEventListener("wheel",h)}},[]),u.jsxs("div",{className:"relative inline-block image-drawer-container",children:[u.jsxs("div",{ref:p,className:"relative inline-block group image-drawer-container",style:{cursor:F?D:"default"},onMouseEnter:n=>{n.stopPropagation(),M()},onMouseLeave:n=>{n.stopPropagation(),W()},onClick:n=>{const a=window.getSelection();a&&a.toString().trim().length>0||n.stopPropagation()},onScroll:n=>{n.stopPropagation()},children:[u.jsx("img",{ref:v,src:l,alt:x||"",style:d,className:N,draggable:!1}),u.jsx("canvas",{ref:m,className:"absolute top-0 left-0 pointer-events-auto",style:{cursor:F?D:"default"},onMouseDown:g,onMouseMove:B,onMouseUp:q,onMouseLeave:q,onTouchStart:g,onTouchMove:B,onTouchEnd:q})]}),u.jsxs("div",{className:"absolute top-0 right-0 -translate-y-full mb-2 flex items-center gap-2 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg p-2 border border-gray-200",children:[!T&&u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),E("black")},className:`w-7 h-7 rounded-full border-2 transition-all hover:scale-110 ${C==="black"?"border-gray-900 scale-110 shadow-md ring-2 ring-gray-300":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:"#000000"}}),u.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),E("red")},className:`w-7 h-7 rounded-full border-2 transition-all hover:scale-110 ${C==="red"?"border-gray-900 scale-110 shadow-md ring-2 ring-red-200":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:"#ff0000"}}),u.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),E("yellow")},className:`w-7 h-7 rounded-full border-2 transition-all hover:scale-110 ${C==="yellow"?"border-gray-900 scale-110 shadow-md ring-2 ring-yellow-200":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:"#ffeb3b"}})]}),u.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),L(!T)},className:`p-2 rounded-md shadow-sm transition-all hover:scale-105 ${T?"bg-red-500 text-white hover:bg-red-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T?u.jsx(ae,{className:"w-4 h-4"}):u.jsx(J,{className:"w-4 h-4"})})]})]})},ve=({htmlString:l,className:x="",enabledHighlight:d=!0,storageKey:N})=>{const p=s.useRef(null),[m,v]=s.useState(null),[w,k]=s.useState(null),[F,f]=s.useState(null),T=s.useRef(0),L=s.useRef(null),[C,E]=s.useState(l),j=s.useRef(!1),g=()=>Date.now().toString()+Math.random().toString(36).slice(2),B=t=>{if(!p.current)return[];const o=[],e=document.createTreeWalker(p.current,NodeFilter.SHOW_ELEMENT,{acceptNode(c){if(!(c instanceof HTMLElement))return NodeFilter.FILTER_REJECT;const b=window.getComputedStyle(c);return(b.display==="block"||b.display==="list-item"||b.display==="table"||["P","DIV","LI"].includes(c.tagName))&&t.intersectsNode(c)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);let r=e.nextNode();for(;r;)o.push(r),r=e.nextNode();return o},q=(t,o)=>{const e=t.extractContents(),r=document.createElement("span");r.className="highlight",r.dataset.highlightId=o,r.appendChild(e),t.insertNode(r),N&&p.current&&setTimeout(()=>{if(p.current)try{localStorage.setItem(`highlights_${N}`,p.current.innerHTML)}catch(c){console.warn("Failed to save highlights:",c)}},0)},W=()=>{if(!d||!m)return;const t=m.cloneRange(),o=g(),e=B(t);e.length===0?q(t,o):e.forEach(r=>{const c=document.createRange();let b=t.startContainer,S=t.startOffset,R=t.endContainer,I=t.endOffset;r.contains(b)||(b=r,S=0),r.contains(R)||(R=r,I=r.childNodes.length);try{c.setStart(b,S),c.setEnd(R,I),c.collapsed||q(c,o)}catch{}}),v(null),k(null),f(null)},M=s.useCallback(()=>{d&&(L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{const t=window.getSelection();if(t&&t.rangeCount>0&&p.current?.contains(t.anchorNode)){const o=t.getRangeAt(0),e=t.toString().trim();if(!o.collapsed&&e.length>0){const r=o.getBoundingClientRect();let c=o.commonAncestorContainer;c.nodeType===Node.TEXT_NODE&&(c=c.parentNode),c&&c.classList&&c.classList.contains("highlight")?(f(c),v(null)):(f(null),v(o));const b=window.innerWidth,S=200,R=50;let I=r.left+window.scrollX+r.width/2;I+S/2>b+window.scrollX?I=b+window.scrollX-S/2-10:I-S/2<window.scrollX&&(I=window.scrollX+S/2+10);let _=r.top+window.scrollY-R-35;_<window.scrollY&&(_=r.bottom+window.scrollY+35),k({x:I,y:_,width:S})}else v(null),f(null),k(null)}else v(null),f(null),k(null)},150))},[d]),i=s.useCallback(()=>{const t=Date.now();t-T.current<300||(T.current=t,M())},[M]),P=s.useCallback(()=>{M()},[M]);s.useEffect(()=>{if(!d)return;document.addEventListener("mouseup",i),document.addEventListener("dblclick",P);const t=e=>{const r=e.target;r.closest("img")||r.closest(".image-drawer-container")||r.tagName==="IMG"||p.current?.contains(r)||(f(null),k(null))},o=e=>{const r=window.getSelection();r&&r.toString().trim().length>0&&e.stopPropagation()};return document.body.addEventListener("click",t),window.addEventListener("scroll",o,{passive:!0}),document.addEventListener("scroll",o,{passive:!0}),()=>{document.removeEventListener("mouseup",i),document.removeEventListener("dblclick",P),document.body.removeEventListener("click",t),window.removeEventListener("scroll",o),document.removeEventListener("scroll",o),L.current&&clearTimeout(L.current)}},[i,P,d]);const D=t=>{t.stopPropagation();const o=t.currentTarget;f(o),v(null);const e=o.getBoundingClientRect(),r=window.innerWidth,c=200,b=50;let S=e.left+window.scrollX+e.width/2;S+c/2>r+window.scrollX?S=r+window.scrollX-c/2-10:S-c/2<window.scrollX&&(S=window.scrollX+c/2+10);let R=e.top+window.scrollY-b-35;R<window.scrollY&&(R=e.bottom+window.scrollY+35),k({x:S,y:R,width:c})},n=()=>{if(d){if(F){const t=F,o=t.parentNode;if(o){for(;t.firstChild;)o.insertBefore(t.firstChild,t);o.removeChild(t)}}else if(m&&!F){const t=m.cloneRange();if(!p.current)return;const o=[],e=document.createTreeWalker(p.current,NodeFilter.SHOW_ELEMENT,{acceptNode(c){return c instanceof HTMLElement&&c.classList.contains("highlight")&&t.intersectsNode(c)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);let r=e.nextNode();for(;r;)o.push(r),r=e.nextNode();o.forEach(c=>{const b=c.parentNode;if(b){for(;c.firstChild;)b.insertBefore(c.firstChild,c);b.removeChild(c)}})}N&&p.current&&setTimeout(()=>{if(p.current)try{localStorage.setItem(`highlights_${N}`,p.current.innerHTML)}catch(t){console.warn("Failed to save highlights:",t)}},0),v(null),f(null),k(null)}};s.useEffect(()=>{E(l),j.current=!1},[l]),s.useEffect(()=>{if(N&&p.current&&!j.current)try{const t=localStorage.getItem(`highlights_${N}`);t?setTimeout(()=>{if(p.current){const o=document.createElement("div");o.innerHTML=t;const e=o.querySelectorAll(".highlight");e.length>0&&e.forEach(r=>{const c=r.getAttribute("data-highlight-id"),b=r.textContent;if(b&&p.current){const S=document.createTreeWalker(p.current,NodeFilter.SHOW_TEXT,null);let R;for(;R=S.nextNode();){const _=(R.textContent||"").indexOf(b);if(_!==-1&&R.parentElement&&!R.parentElement.classList.contains("highlight"))try{const H=document.createRange();H.setStart(R,_),H.setEnd(R,_+b.length);const $=document.createElement("span");$.className="highlight",$.dataset.highlightId=c||Date.now().toString();const V=H.extractContents();$.appendChild(V),H.insertNode($);break}catch{}}}})}j.current=!0},150):j.current=!0}catch(t){console.warn("Failed to restore highlights:",t),j.current=!0}},[N,C]);const a=typeof C=="string"&&C.trim().length>0?C:l,h=de(a),y=ce(h,{replace:t=>{if(t.type==="tag"&&t.name==="span"&&t.attribs&&t.attribs.class&&t.attribs.class.includes("highlight"))return s.createElement("span",{...t.attribs,onClick:D,style:{cursor:"pointer"},key:t.attribs["data-highlight-id"]||void 0},t.children&&ue.domToReact(t.children));if(t.type==="tag"&&t.name==="img"&&t.attribs){const{src:o,alt:e,style:r,className:c}=t.attribs;let b={};return r&&r.split(";").forEach(S=>{const[R,I]=S.split(":").map(_=>_.trim());if(R&&I){const _=R.replace(/-([a-z])/g,H=>H[1].toUpperCase());b[_]=I}}),u.jsx(he,{src:o||"",alt:e||"",style:b,className:c||""},o||Math.random().toString())}}});return u.jsxs(u.Fragment,{children:[u.jsx("style",{children:`
        .highlight {
          background-color: #fde68a;
        }
      `}),u.jsx("div",{ref:p,className:`w-full text-sm text-[--foreground] ${x}
          [&_table]:w-full [&_table]:border-collapse
          [&_td]:border [&_td]:border-[--border] [&_td]:p-2
          [&_th]:border [&_th]:border-[--border] [&_th]:p-2
          [&_p]:mb-2 [&_p]:text-[--foreground]
          [&_h3]:text-lg [&_h3]:font-semibold [&_h3]:mb-2 [&_h3]:text-[--foreground]
          [&_strong]:font-bold [&_em]:italic select-text`,style:{userSelect:"text"},children:y}),d&&w&&(m||F)&&u.jsxs("div",{className:"absolute z-50 flex gap-2 rounded-lg border bg-muted p-2 shadow-lg -translate-x-1/2",style:{left:w.x,top:w.y},children:[!F&&u.jsxs(O,{size:"sm",onClick:W,children:[u.jsx(ie,{className:"mr-1 h-4 w-4"})," Highlight"]}),u.jsxs(O,{size:"sm",variant:"destructive",onClick:n,disabled:!F&&!m,children:[u.jsx(J,{className:"mr-1 h-4 w-4"})," Clear"]})]})]})};let A=null;try{const l=require("react-router-dom");typeof l.useBlocker=="function"&&(A=l.useBlocker)}catch{}const ke=l=>{const{user:x}=X(),d=Q(),N=Z(),p=typeof l=="boolean"?{shouldBlock:l}:l,{shouldBlock:m,audioRef:v,timeLeft:w,isAudioPlaying:k,customMessage:F}=p,f=x?.role===U.STUDENT,T=()=>v?.current?!v.current.paused&&!v.current.ended:!1,L=()=>w==null?!1:w>0,C=s.useCallback(i=>i.includes("/readings/")||i.includes("/listenings/")||i.includes("/writings/")||i.includes("/speakings/"),[]),E=s.useCallback(()=>!f||!m?!1:L()||m,[f,m,w]),j=s.useCallback(()=>navigator.platform.toUpperCase().indexOf("MAC")>=0||navigator.userAgent.toUpperCase().indexOf("MAC")>=0,[]),g=s.useCallback(()=>{const i=document.documentElement;j()?i.webkitRequestFullscreen?i.webkitRequestFullscreen():i.requestFullscreen&&i.requestFullscreen().catch(D=>{console.error("Fullscreen error:",D)}):i.requestFullscreen?i.requestFullscreen().catch(D=>{console.error("Fullscreen error:",D)}):i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()},[j]),B=s.useCallback(()=>{document.exitFullscreen&&document.fullscreenElement&&document.exitFullscreen().catch(i=>{console.error("Fullscreen rejimidan chiqishda xato:",i)})},[]),q=s.useCallback(i=>{const P=E();f&&P&&(i&&i.preventDefault(),history.pushState(null,"",d.pathname),alert("You cannot leave the page during the test."),g())},[f,m,v,w,d.pathname,N,g]),W=s.useCallback(()=>{if(!f)return!1;const i=C(d.pathname),P=L();return i&&P&&m},[f,d.pathname,w,m,C,L]),M=A?A(W):null;s.useEffect(()=>{M&&M.state==="blocked"&&(alert("You cannot leave the page during the test. Please wait until the test time is up."),M.reset(),g())},[M,g]),s.useEffect(()=>{if(!f)return;const i=C(d.pathname),P=L();if(!(i&&P&&m))return;const n=a=>{const y=a.target.closest("a[href]");if(y&&y.href)try{const t=new URL(y.href),o=new URL(window.location.href);if(t.origin===o.origin&&t.pathname!==o.pathname&&i&&!C(t.pathname))return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),alert("You cannot leave the page during the test. Please wait until the test time is up."),g(),!1}catch{}};return document.addEventListener("click",n,!0),()=>{document.removeEventListener("click",n,!0)}},[f,d.pathname,w,m,C,L,g]),s.useEffect(()=>{if(!f)return;if(!m){B();const e=`fullscreen_alert_shown_${d.pathname}`;sessionStorage.removeItem(e);return}const i=`fullscreen_alert_shown_${d.pathname}`;sessionStorage.removeItem(i),g();const P=e=>{if(E()&&f)return e.preventDefault(),e.returnValue="You cannot reload the page during the test.",history.pushState(null,"",d.pathname),"You cannot reload the page during the test."},D=e=>{const r=E();if(r&&f&&(e.key==="F5"||e.key==="F4"&&e.altKey||e.ctrlKey&&!e.shiftKey&&(e.key==="r"||e.key==="R")||e.ctrlKey&&e.shiftKey&&(e.key==="r"||e.key==="R")||e.ctrlKey&&e.key==="F5"||e.metaKey&&!e.shiftKey&&(e.key==="r"||e.key==="R")||e.metaKey&&e.shiftKey&&(e.key==="r"||e.key==="R")))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),alert("You cannot reload the page during the test."),g(),history.pushState(null,"",d.pathname),!1;r&&e.key==="Escape"&&(e.preventDefault(),e.stopPropagation(),alert("You cannot leave the page during the test."),g()),r&&e.key==="F11"&&(e.preventDefault(),confirm(`Test tugamaguncha fullscreen rejimidan chiqish taqiqlangan!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g()),r&&(e.altKey&&e.key==="Tab"||e.ctrlKey&&e.key==="Tab")&&(e.preventDefault(),confirm(`Test tugamaguncha boshqa oynaga o'tish taqiqlangan!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())},n=()=>{if(E()&&!document.fullscreenElement){const r=`fullscreen_alert_shown_${d.pathname}`;sessionStorage.getItem(r)?setTimeout(()=>{g()},50):(sessionStorage.setItem(r,"true"),alert("You cannot exit the test until the test time is up"),setTimeout(()=>{g()},100))}},a=e=>{E()&&(e.preventDefault(),confirm(`Test tugamaguncha o'ng tugma menyusi ishlamaydi!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())},h=e=>{E()&&(e.key==="F12"||e.ctrlKey&&e.shiftKey&&(e.key==="I"||e.key==="J")||e.ctrlKey&&e.key==="u")&&(e.preventDefault(),confirm(`Test tugamaguncha developer tools ishlamaydi!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())};window.addEventListener("beforeunload",P),window.addEventListener("keydown",D),window.addEventListener("keydown",h);const y=e=>{q(e)};window.addEventListener("popstate",y),document.addEventListener("fullscreenchange",n),document.addEventListener("contextmenu",a);const t=()=>{E()&&T()&&setTimeout(()=>{window.focus(),g()},100)};window.addEventListener("blur",t);const o=e=>{E()&&(e.preventDefault(),history.pushState(null,"",d.pathname),confirm(`Test tugamaguncha browser navigation tugmalari ishlamaydi!

Fullscreen rejimiga qaytishni xohlaysizmi?`)&&g())};return E()&&history.pushState(null,"",d.pathname),window.addEventListener("hashchange",o),()=>{window.removeEventListener("beforeunload",P),window.removeEventListener("keydown",D),window.removeEventListener("keydown",h),window.removeEventListener("popstate",y),document.removeEventListener("fullscreenchange",n),document.removeEventListener("contextmenu",a),window.removeEventListener("blur",t),window.removeEventListener("hashchange",o)}},[f,m,v,w,q,g,B,d.pathname,E,L])},Ee=(l,x,d,N=!0,p)=>{const[m,v]=s.useState(l),[w,k]=s.useState(!1),[F,f]=s.useState(""),T=s.useRef(null),L=s.useRef(null),C=s.useRef(!1),E=s.useRef(!1),j=()=>{L.current&&(clearInterval(L.current),L.current=null)};s.useEffect(()=>{l!==null?(T.current=Date.now()+l*1e3,v(l),C.current=!1):(T.current=null,v(null))},[l]),s.useEffect(()=>{if(l===null||w||!N&&!E.current)return;!E.current&&l!==null&&(T.current=Date.now()+l*1e3,v(l)),E.current=!0;const i=()=>{if(T.current===null)return;const P=Math.max(0,Math.round((T.current-Date.now())/1e3));v(P),P<=0&&!w&&!C.current&&(j(),C.current=!0,k(!0),ee.error("The time limit has expired."),d(),p&&setTimeout(()=>{p()},100))};return i(),L.current=setInterval(i,1e3),()=>{(w||!E.current)&&j()}},[l,w,d,N]),s.useEffect(()=>{x.length>0&&!F&&f(`tab-${x[0].id}`)},[x,F]);const g=x.findIndex(i=>`tab-${i.id}`===F);return{timeLeft:m??0,formatTime:i=>`${Math.floor(i/60).toString().padStart(2,"0")}:${(i%60).toString().padStart(2,"0")}`,activeTab:F,setActiveTab:f,currentTabIndex:g,handlePrevious:()=>g>0&&f(`tab-${x[g-1].id}`),handleNext:()=>g<x.length-1&&f(`tab-${x[g+1].id}`),isTestFinished:w,finishTest:()=>{l!==null&&!w&&(j(),d(),k(!0))}}};export{be as C,xe as F,ve as H,he as I,ke as a,Ee as u};
